---
title: "TSKaigi 2024参加レポート"
emoji: "🤖"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["TypeScript","カンファレンス"]
published: false
---
こんにちは、株式会社toridoriの[yrmz](https://twitter.com/yary_engineer) です。
5月11日に中野セントラルパーク カンファレンスにて開催されたTsKaigiに参加したレポートをお届けします。

## Prisma ORMを2年運用して培ったノウハウを共有する
[Prisma ORMを2年運用して培ったノウハウを共有する](https://speakerdeck.com/tockn/prisma-ormwo2nian-yun-yong-sitepei-tutanouhauwogong-you-suru)

- 複数テーブルの取得を１つのコードにまとめても、実際にはテーブルごとにSQLが発行されてしまう。
  - パフォーマンスに問題がない場合以外は生クエリを直接記述して解決している
  - previewFeatureとして提供されているrelationJoinsを使うと、joinしたクエリにするかどうかを選択できる
- create,update,delete時にselect文も一緒に発行されてしまう。
  - `select: false`とすることでcreate,update,delete時にselect文が発行されないPRが出されている。（prisma@5.9でPostrgeSQL,CockroachDBに対応したようです。）
- REST APIのレスポンスの型を指定していても、prismaが全てのカラムを返してしまうとレスポンスに含まれてしまう。
  - zodの機能を使うことで型で定義していない情報の漏洩を防いでいる。

### 感想
　toridoriではGraphQLを採用しています。<br>
そのため、Mutation呼び出しの戻り値として操作した結果を返す必要があるのですが、prismaがcreate,update,deleteと同時にselectしてくれるのは便利だと感じていました。<br>
しかし、テーブル操作時に必ずしも操作結果を取得する必要があるわけではないため、無駄なクエリが発行されてしまうケースも存在していました。<br>
`select: false`ができるようになることで、プロダクトのパフォーマンス向上に期待したいです。<br>
　REST APIの場合は、レスポンスの型を定義しても、prismaでカラムを指定せずに取得するとクライアントに全て返してしまうというのが驚きでした。<br>
zodを使うことで意図しないカラムの漏洩を防げるというのは驚きでした。


## まとめ
はじめて参加したTypeScriptのカンファレンスでしたが、<br/>
コードジェネレータ・フルTypeScript開発に関する発表が多い印象でした。<br/>
